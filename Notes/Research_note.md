# 研究ノート

### 2019/04/11
　最近はすっかり研究ノートの更新をとめてしまっていたが，ここらへんで再開しようと思う。再開を機に，wordでの環境をやめて，mdで記録して，Gitにmergeできるようにしたいと思った。  $\LaTeX$ 記法が使えて便利
##### Advancing Human Assessment [Chapter 3]
###### Psychometric Contributions: Focus on Test Scores
　テスト得点にフォーカスした章だった。基本的な古典的テスト理論の式から，信頼性係数，真値から観測値への回帰得点など盛りだくさんだった。基本的に古典的テスト理論(Classical Test Theory)の範疇の話だったが，途中で欠測値の話もあって面白かった。特にKristofの提案した，2部以上に分割した場合の信頼性係数などは日本のテキストでは今まで見たことがなかったもので興味深かった。  
　基本的なテスト$X$からテスト$Y$への回帰得点の式は，
$$
\begin{eqnarray}
Y = \mu(Y|X) + \epsilon = \mu_Y + \rho_{X, Y}\frac{\sigma_Y}{\sigma_Y}(X-\mu_X)+\epsilon
\end{eqnarray}
$$

である。$\rho_{X, Y}\frac{\sigma_Y}{\sigma_Y}$ が回帰係数の傾きにあたる。観測値から真値を推定する式は[池田(1973)](https://1drv.ms/b/s!AmmvfkpgY6-miNkvVhdUtaueG9-50Q)を参考にして，
$$
\hat T = \rho(X)X+(1-\rho(X))\mu(X)
$$
で表されることが分かる。なお $\rho(X)$ はテスト得点$X$の信頼性係数である。この式が意味するところはテスト$X$の信頼性係数が高ければ観測値の得点がそのまま真値に一致し，そうでなければテスト$X$の得点が重みづけられるという内容になっている。[Brennan](https://1drv.ms/b/s!AmmvfkpgY6-miNku6OA25627QDu-fw)のテキストにも同様の内容がある。

### 2019/04/12
##### Advancing Human Assessment [Chapter 4]  

##### GIRTモデルについての検討  

　野澤さんに話したところ，結構興味を示してくれた。パラメタ $\phi$ の解釈をどうするかが今後の大きな課題になると思う。Torgersonの一般正規累積モデルをよく理解しなくてはいけないだろう。[孫・芝(1989)](https://www.jstage.jst.go.jp/article/jjep1953/38/4/38_360/_pdf)では， $\phi$ の解釈についても触れており，個人能力パラメタが $\theta$　と $\phi$ であるような受検者がある特定のパラメタを持つ項目群に正答する確率を，項目特性曲線が返す確率であると解釈すれば， $\phi$ が個人の能力値の変動を表していると解釈しても問題ないとしている。つまり，「まったく同じ項目」ではなく「問題自体は違うが項目パラメタが同じ項目群」を想定するのである。解釈自体は不可能ではないが，テストの特性にもよるだろう。

### 2019/04/15
##### GIRTモデルについての検討 その2
　$\phi$ の推定値の改善。モデルの仮定の上で， $\theta$ と $\phi$ は独立であるとしているから，仮に相関を仮定したモデルを適用しても，そこまで改善は見込めないはず。  
　標本の大きさの問題ではないかと考え，ひとまず項目数を200で推定してみたが，若干相関係数が高くなった（0.5 -> 0.7程度）。次は項目数をさらに倍の400で推定を実行してみたところ，相関係数が0.85程度まで上昇した。詰まるところ，安定した $\phi$ パラメタの推定には通常のIRTモデルよりも，より多くの項目が必要になる。
##### GRMの期待得点から $b_{jk}$ を推定したい
　一筋縄ではいかない。期待得点自体が，他のカテゴリの反応確率の影響を受けているため。  
　推定期待得点関数 $F(\theta|\delta)$ を任意の多項式などで推定し，そこからカテゴリ $k$ までの期待得点関数 $E_j(\theta)$ を引くことで，観測されたかった $k+1$ の境界カテゴリ曲線(Boundary Category Curve, BCC)をえることができる。さらにそのBCCの $b_{k+1}^\ast$ を求め（確率値50
％の位置の $theta$ がそれに等しい）， $b_k+2$（もしくは0）から引くような形で $P_{j,k+1}$ を求める事ができる。

### 2019/04/16
##### 不等式制約付き最適化について調べる
　単調増加の制約をおいた状態でカーブフィッティングをおこなうためには，不等式制約付き最適化の問題を解く必要があるはずである。調べたけど，基本的にはラグランジュで解くことができる様だ（[[1]](https://www.iwanttobeacat.com/entry/2018/01/30/210446)，[[2]](http://www2.kaiyodai.ac.jp/~yoshi-s/Lectures/Optimization/2013/lecture_4.pdf)）。  
　不等式制約条件付きの最小化の場合，まずラグラジアンをパラメタについて偏微分して，連立方程式を解き，そこから得られた $\lambda$ にの関数を最大化すれば良い。仮に解析的に解けないのであれば，反復計算を必要とするだろう。

##### カーブフィッティング in R
　lm, nls, solnp関数は試した。それからガウス過程回帰も試してみた。プロットのデータを見たところ，17カテゴリあるデータでは，他の項目の影響を受けるせいか，同じ得点でもかなり $\theta$ にばらつきがある。これではフィッティングがあまりうまくいかなそう。ぱっと思いついた解決策としては，項目得点ではなく，テスト全体の得点をrescalingして観測得点として用いるのはどうだろうか。    
　そもそも観測得点の方は順序カテゴリカルなデータなのだから，回帰の方法にも工夫が必要なのではないか？順序ロジットとか？  
　スプライン関数についてすこし調べてみたい。入力空間を分割し，閣僚域内で多項式を当てはめてカーブフィッティングできる。これは有力そう。
