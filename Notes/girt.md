# GIRT model
##### 2019/04/13
----

### 正規累積モデル  
　まずは正規累積モデルから考えよう。正規累積モデル(Normal Ogive Model, NOM)は正規累積関数を $\Phi$ とおくと，
$$
\Phi(z)=1/\sqrt{2\pi}\int_{-\infty}^L\exp(z)
$$
where
$$
\begin{eqnarray}
z = -\frac{1}{2}\left(\frac{(\theta - \mu)}{\sigma}\right)^2\\\\
L = a(\theta - b)
\end{eqnarray}
$$
と表現することができる。そしてこれは正規累積モデルにおける $\theta$ の位置における反応確率，
$$
P(\theta) = \Phi(z)
$$
と一致している。一般的に $a$ パラメタは識別力， $b$ パラメタは困難度と呼ばれる。ここでは3パラメタのモデルは扱わない。

### 一般正規累積モデル

　一般正規累積モデルでは受検者の特性値 $\theta$ や項目の特性値 $b$ を変動的に考える。このモデルはTogersonの比較判断の法則をモデルに成り立っている。  
　基本的な式は，正規累積モデルと同じであるが，積分区間を決めるための $L$ の式が異なる。
$$
L =
$$

## 比較判断の法則

　IRTと比較判断の法則は互いに異なる理論であるが，関連もある。GIRTモデルを理解する上ではまずは **Torgersonの比較判断の法則** を理解する必要があるだろう。 　
####*Postulates*  
1. 受検者の刺激に対する反応は **discriminal process(弁別過程)** として観測され，それは心理学的連続体上の値であると解釈される。  
2. 感覚器官における反応は一瞬であるため，観測される刺激はいつも同じ弁別過程であるとは限らないが，ある一点よりも高いか，あるいは低いかで判断することができる。そしてその弁別過程は正規分布に従うと仮定する。
3. 弁別過程が従う分布の平均と標準偏差(SD)は，その刺激のscale value(尺度値)とdiscriminal dispersion(弁別分散)と解釈される。  

　あらゆる弁別過程の差は **discriminal difference()** と呼ばれ，ある二組の刺激の弁別過程が多数回観測されたとき，その差は正規分布に従うと仮定する。弁別過程の差の平均は，二つの弁別過程の平均の差として扱われ，その分散は二つの弁別過程の共分散と相関係数を用いて，
$$
\sigma_{d1-d2} = \sqrt{(\sigma^2_1 + \sigma^2_2-2r_{12}\sigma_1\sigma_2)}
$$
と表される。二つの弁別過程の差には単位に不定性がある。通常の観測値の差は，
$$
x_{12} = d_1-d_2
$$
として表現されるが，それを差の標準偏差で標準化することで，
$$
s_1 - s_2 = x_{12}/\sigma_{12}
$$
と表現することもできる。この式の形が **the complete form of the law of comparative judgment 比較判断の法則の完全形式** である。しかし，このままではパラメタが多すぎて解くことができないため，いくつかの制約をおいて解を求める方法をTorgerson(1958)は提案している。  
　提案されている方法はCase I ~ Case V が存在する。    

----
- Case I
  - 一人の受検者に同じ試行を何度も繰り返した結果をモデルが含んでいると仮定する。
- Case II
  - 受検者ごとに各試行は一回だけと仮定する。この場合正規分布する弁別仮定の差は，無数の受検者集団からサンプリングされるものと仮定している。
- Case III
  - モデルは受検者と試行の両方の繰り返しを含む。各受検者ごとに試行ごとの刺激対に対する反応が比較される。このケースでは個人と個人内の試行は交換可能であると仮定される。この仮定では共分散の項が一定であるように制約がおかれる。つまり弁別仮定の差の分散は，
  $$
  \sigma_{d1-d2} = \sqrt{(\sigma^2_1 + \sigma^2_2}
  $$
  と表すことができる。さらに制約をおく場合，すべての刺激対において共分散を0とおかれることもある。
- Case IV
  - Case IIIでおかれた相関がすべての対において等しいという制約に加えて，弁別過程の分散は小さいものと仮定している。この仮定においては，刺激対間の相関は0だと仮定される。
- Case V
  - すべての刺激対の弁別過程の分布の標準偏差が等しいと仮定する。
~~なお，これらの解法のうち，一般項目反応モデルに用いられるものはCase IIIであり，通常の項目反応モデルに用いられるものがCase Vである。~~ TorgersonはCase Vにおける最小二乗法で解を求める方法を提案したが，Case IIIの方法は提案していない。
----

## カテゴリ判断の法則  

　ここまでに述べた比較判断の法則は，あくまでも刺激対に対して，複数回の試行や，複数人の受検者から得られたデータセットを基に，パラメタを推定するという問題を目的としていた。しかし，IRTは受検者が特定の項目群に反応した反応データが与えられた条件下でのパラメタ推定を目的としている。  
　カテゴリ判断の法則においては，比較判断の法則をより一般化し，以下の仮定をおく。

1. 受検者の心理的連続体はいくつかの順序カテゴリ（もしくはステップ）に分割される。
2. 様々な理由によりカテゴリ境界はかならずしもいつも特定の値として位置づけられるのではなく，正規分布に従って分布している。また，異なるカテゴリ境界はそれぞれ異なる平均と弁別分散（$dispersion$）をもつ。
3. 受検者は，連続体上の刺激の値がカテゴリ境界よりも小さければ必ず，与えられた刺激を与えられたカテゴリ境界よりも低い（下）であると判断する。

　今までは刺激対でしか何らかの量を捉えることができなかったのに対し，これらの過程により，ある刺激単体でも心理的連続体上の値を考えることができる。
　カテゴリ判断の状況における方程式は，
$$
t_g - s_j = x_{ig}(\sigma_j^2 + \sigma_g^2 - 2r_{jg}\sigma_j\sigma_g)^{1/2}\\
$$
$where$

- $j$: 項目数
- $g$: カテゴリ数
- $t_g$: カテゴリ境界の位置パラメタ(mean location)
- $\sigma_g$: $g$番目のカテゴリ境界の分散
- $r_{jg}: 刺激 $j$ とカテゴリ $g$ の瞬間的な位置の相関
- $x_{jg}: 刺激 $j$ が境界 $g$ 以下だと判断される回数の割合

　比較判断の法則の時と同様，このままの形式では解くことができない。パラメタの数は受検者数を $n$ ，カテゴリ数を $m$ とすると，$2(m+n+1)+mn$ 個だけ存在する。  

- Case I
  - ひとりの受検者において複数回の試行を繰り返しおこなうモデル
- Class II
  - 複数人の受検者に対して各試行が一度だけ提示される。
- Class III
  - 受検者と試行の両方が繰り返し測定されるモデル。それぞれの刺激は各受検者で複数回判断される。

　これらのモデルを解くためにはいくつかの条件が必要となる。

- Condition A　共分散を含む項を定数とおく
- Condition B　すべてのカテゴリで分散 $\sigma_g$ を定数とおき，かつ相関の項を無視する。
- Condition C　すべての試行において受検者の分散 $\sigma_j$ を一定とし，かつ相関の項を無視する。
- Condition D　$\sigma_g, \sigma_j, r_{gj}$ のすべてを定数とする。

　Torgerson (1958) のp.209のTable1をみるに，GIRTモデルはCase I ~ IIIのCondition Aに基づいているようだ。Caseによってパラメタの解釈が異なる。当然，テストデータ行列を考えればCase II かCase IIIが妥当な解釈であると考えられる。現実的なテストを考えれば同じ問題は1度しか提示されない。それは同じ受検回であれば，同じ問題を何度解こうが，理想的には同じ回答が得られるはずだからである。フリースローのように，同じ試行でも入る，入らないという結果が異なる場合はCase IIIが通用するかもしれない。
